openapi: 3.0.3
info:
  title: ğŸ… í† ë§ˆí†  ìŠ¤ë§ˆíŠ¸íŒœ API
  description: |
    Seed Farm í† ë§ˆí†  ìŠ¤ë§ˆíŠ¸íŒœ ê´€ë¦¬ ì‹œìŠ¤í…œ API ë¬¸ì„œ
    
    ## ì„œë²„ êµ¬ì„±
    - **n8n ì›Œí¬í”Œë¡œìš° ì„œë²„**: seedfarm.co.kr:5678 (ì™¸ë¶€ ì ‘ê·¼)
    - **ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼**: 192.168.49.219:8080 (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬)
    - **ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡ ì„œë²„**: 192.168.49.101:8002 (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬)
    - **YOLO ë¶„ì„ ì„œë²„**: 192.168.49.101:8001 (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬)
    
    ## ì£¼ìš” ê¸°ëŠ¥
    - ì‹¤ì‹œê°„ í† ë§ˆí†  ëª¨ë‹ˆí„°ë§ (YOLO ê¸°ë°˜ 4-class ë¶„ë¥˜)
    - ì‹œì¥ ê°€ê²© ì¡°íšŒ (KAMIS + ë„¤ì´ë²„ ì‡¼í•‘)
    - AI ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡
    - ë³‘í•´ì¶© ì§„ë‹¨ (Gemini AI)
    - ì¹´ë©”ë¼ ì›ê²© ì œì–´
    
  version: 1.0.0
  contact:
    name: Seed Farm Development Team
    email: dev@seedfarm.co.kr
  license:
    name: MIT

servers:
  - url: http://seedfarm.co.kr:5678/webhook
    description: n8n ì›Œí¬í”Œë¡œìš° ì„œë²„ (Production)
  - url: http://192.168.49.219:8080
    description: ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼ ì„œë²„ (Internal)
  - url: http://192.168.49.101:8002
    description: ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡ ì„œë²„ (Internal)

tags:
  - name: ì‹¤ì‹œê°„ ë°ì´í„°
    description: InfluxDB ê¸°ë°˜ í† ë§ˆí†  ëª¨ë‹ˆí„°ë§ ë°ì´í„°
  - name: ì‹œì¥ ê°€ê²©
    description: KAMIS ë„ë§¤ê°€ + ë„¤ì´ë²„ ì†Œë§¤ê°€ ì¡°íšŒ
  - name: ì¹´ë©”ë¼ ì œì–´
    description: ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼ ì›ê²© ì œì–´
  - name: AI ë¶„ì„
    description: í† ë§ˆí†  ì´ë¯¸ì§€ ë¶„ì„ ë° ë³‘í•´ì¶© ì§„ë‹¨
  - name: ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡
    description: ML ê¸°ë°˜ ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡
  - name: ì±—ë´‡
    description: Gemini AI ê¸°ë°˜ ë†ì—… ìƒë‹´

paths:
  # ==================== ì‹¤ì‹œê°„ ë°ì´í„° ====================
  /data-realtime:
    get:
      tags:
        - ì‹¤ì‹œê°„ ë°ì´í„°
      summary: ì‹¤ì‹œê°„ í† ë§ˆí†  ë°ì´í„° ì¡°íšŒ
      description: |
        InfluxDBì—ì„œ ìµœê·¼ 1ì‹œê°„ ë‚´ ë§ˆì§€ë§‰ YOLO ë¶„ì„ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
        
        **YOLO í´ë˜ìŠ¤ ì„¤ëª…:**
        - Ready: ìˆ˜í™• ê°€ëŠ¥í•œ ì™„ìˆ™ í† ë§ˆí† 
        - Not_Ready: ë¯¸ì„±ìˆ™ í† ë§ˆí† 
        - Disease_Bad: ë³‘í•´ì¶© ê°ì—¼ í† ë§ˆí† 
        - Truss: í™”ë°© (ê½ƒë´‰ìš°ë¦¬)
      operationId: getRealtimeData
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RealtimeData'
              example:
                Ready: 45
                Not_Ready: 23
                Disease_Bad: 2
                Truss: 8
        '500':
          description: ì„œë²„ ì˜¤ë¥˜
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /data-history:
    get:
      tags:
        - ì‹¤ì‹œê°„ ë°ì´í„°
      summary: ê³¼ê±° ë°ì´í„° ì¡°íšŒ
      description: ì§€ì •ëœ ì‹œê°„ ë²”ìœ„ì˜ í† ë§ˆí†  ë¶„ì„ íˆìŠ¤í† ë¦¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getHistoryData
      parameters:
        - name: hours
          in: query
          description: ì¡°íšŒí•  ì‹œê°„ ë²”ìœ„ (ê¸°ë³¸ê°’ 24ì‹œê°„)
          required: false
          schema:
            type: number
            default: 24
            example: 24
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryData'
              example:
                data:
                  - time: "2024-11-21T06:00:00Z"
                    Ready: 40
                    Not_Ready: 20
                    Disease_Bad: 1
                    Truss: 7
                  - time: "2024-11-21T06:10:00Z"
                    Ready: 42
                    Not_Ready: 21
                    Disease_Bad: 1
                    Truss: 7

  /data-summary:
    get:
      tags:
        - ì‹¤ì‹œê°„ ë°ì´í„°
      summary: ì¼ì¼ ìš”ì•½ ë°ì´í„°
      description: ì˜¤ëŠ˜ 00:00ë¶€í„° í˜„ì¬ê¹Œì§€ì˜ í† ë§ˆí†  ë°ì´í„° ìš”ì•½ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getDailySummary
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DailySummary'
              example:
                total_ready: 450
                total_not_ready: 230
                total_disease: 15
                avg_truss: 8

  # ==================== ì‹œì¥ ê°€ê²© ====================
  /price-compare:
    get:
      tags:
        - ì‹œì¥ ê°€ê²©
      summary: ë„ë§¤ê°€ vs ì†Œë§¤ê°€ ë¹„êµ
      description: |
        KAMIS ë„ë§¤ ì‹œì¥ê°€ì™€ ë„¤ì´ë²„ ì‡¼í•‘ ì†Œë§¤ê°€ë¥¼ ë¹„êµí•©ë‹ˆë‹¤.
        
        **ë°ì´í„° ì†ŒìŠ¤:**
        - ë„ë§¤ê°€: KAMIS API (ê°€ë½ì‹œì¥ ê¸°ì¤€)
        - ì†Œë§¤ê°€: ë„¤ì´ë²„ ì‡¼í•‘ API (ì™„ìˆ™ í† ë§ˆí†  1kg ê¸°ì¤€)
      operationId: getPriceCompare
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceCompare'
              example:
                success: true
                date: "2024-11-28"
                wholesale_summary:
                  high: 3500
                  mid: 2800
                  cherry: 8500
                online_summary:
                  lowest_price: 5900
                  lowest_mall: "ì¿ íŒ¡"
                  median_price: 7500
                  average_price: 7200
                comparison:
                  - grade: "ìƒí’ˆ"
                    wholesale_price: 3500
                    online_lowest: 5900
                    margin_rate: 68

  /price-history:
    get:
      tags:
        - ì‹œì¥ ê°€ê²©
      summary: ê°€ê²© ì¶”ì´ ì¡°íšŒ
      description: ì§€ì •ëœ ê¸°ê°„ì˜ í† ë§ˆí†  ê°€ê²© ë³€ë™ ì¶”ì´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getPriceHistory
      parameters:
        - name: start
          in: query
          description: ì‹œì‘ ë‚ ì§œ (YYYY-MM-DD)
          required: true
          schema:
            type: string
            format: date
            example: "2024-11-21"
        - name: end
          in: query
          description: ì¢…ë£Œ ë‚ ì§œ (YYYY-MM-DD)
          required: true
          schema:
            type: string
            format: date
            example: "2024-11-28"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceHistory'
              example:
                success: true
                period:
                  start: "2024-11-21"
                  end: "2024-11-28"
                count: 7
                stats:
                  high:
                    min: 3200
                    max: 3800
                    avg: 3500
                    change: 200
                data:
                  - date: "2024-11-21"
                    high: 3400
                    mid: 2700
                  - date: "2024-11-22"
                    high: 3500
                    mid: 2800

  /market-price:
    get:
      tags:
        - ì‹œì¥ ê°€ê²©
      summary: KAMIS ì‹œì¥ ê°€ê²© (ë‹¨ì¼)
      description: ì˜¤ëŠ˜ ë‚ ì§œì˜ KAMIS ë„ë§¤ ì‹œì¥ê°€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getMarketPrice
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MarketPrice'

  # ==================== ì¹´ë©”ë¼ ì œì–´ ====================
  /camera-status:
    get:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ì¹´ë©”ë¼ ìƒíƒœ ì¡°íšŒ
      description: ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼ì˜ í˜„ì¬ ìƒíƒœë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getCameraStatus
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CameraStatus'
              example:
                monitoring: true
                interval: 600
                last_capture: "2024-11-21T07:20:00Z"
                white_balance: "auto"

  /camera-capture:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ì¦‰ì‹œ ì´¬ì˜
      description: |
        ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼ë¡œ ì¦‰ì‹œ ì´¬ì˜ í›„ YOLO ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        ê²°ê³¼ëŠ” InfluxDBì— ì €ì¥ë©ë‹ˆë‹¤.
      operationId: captureNow
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptureResult'
              example:
                success: true
                data:
                  Ready: 45
                  Not_Ready: 23
                  Disease_Bad: 2
                  Truss: 8
                  ripeness_rate: 66
                  disease_rate: 4
                timestamp: "2024-11-21T07:30:00Z"

  /capture-test:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: í…ŒìŠ¤íŠ¸ ì´¬ì˜ (ëœë¤ ë°ì´í„°)
      description: |
        ì‹¤ì œ ì¹´ë©”ë¼ ì—†ì´ ëœë¤ í† ë§ˆí†  ë°ì´í„°ë¥¼ ìƒì„±í•˜ì—¬ InfluxDBì— ì €ì¥í•©ë‹ˆë‹¤.
        í…ŒìŠ¤íŠ¸/ê°œë°œ ìš©ë„ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
      operationId: captureTest
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptureResult'

  /camera-start:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ëª¨ë‹ˆí„°ë§ ì‹œì‘
      description: ì„¤ì •ëœ ê°„ê²©ìœ¼ë¡œ ìë™ ì´¬ì˜ì„ ì‹œì‘í•©ë‹ˆë‹¤.
      operationId: startMonitoring
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /camera-stop:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ëª¨ë‹ˆí„°ë§ ì¤‘ì§€
      description: ìë™ ì´¬ì˜ì„ ì¤‘ì§€í•©ë‹ˆë‹¤.
      operationId: stopMonitoring
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /camera-interval:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ì´¬ì˜ ê°„ê²© ì„¤ì •
      description: ìë™ ì´¬ì˜ ê°„ê²©ì„ ì„¤ì •í•©ë‹ˆë‹¤.
      operationId: setCaptureInterval
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - interval
              properties:
                interval:
                  type: integer
                  description: ì´¬ì˜ ê°„ê²© (ì´ˆ)
                  enum: [60, 300, 600, 1800, 3600]
                  example: 600
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /camera-white-balance:
    post:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: í™”ì´íŠ¸ ë°¸ëŸ°ìŠ¤ ì„¤ì •
      description: ì¹´ë©”ë¼ í™”ì´íŠ¸ ë°¸ëŸ°ìŠ¤ ëª¨ë“œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
      operationId: setWhiteBalance
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mode
              properties:
                mode:
                  type: string
                  description: í™”ì´íŠ¸ ë°¸ëŸ°ìŠ¤ ëª¨ë“œ
                  enum: [auto, fluorescent, tungsten, daylight]
                  example: "auto"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ==================== AI ë¶„ì„ ====================
  /capture-analyze:
    post:
      tags:
        - AI ë¶„ì„
      summary: í† ë§ˆí†  ì´ë¯¸ì§€ ë¶„ì„ (YOLO)
      description: |
        ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë¥¼ YOLO ëª¨ë¸ë¡œ ë¶„ì„í•˜ì—¬ í† ë§ˆí† ë¥¼ ë¶„ë¥˜í•©ë‹ˆë‹¤.
        
        **ë¶„ë¥˜ í´ë˜ìŠ¤:**
        - Ready: ìˆ˜í™• ê°€ëŠ¥
        - Not_Ready: ë¯¸ì„±ìˆ™
        - Disease_Bad: ë³‘í•´
        - Truss: í™”ë°©
      operationId: analyzeTomato
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  format: byte
                  description: Base64 ì¸ì½”ë”©ëœ ì´ë¯¸ì§€
                mimeType:
                  type: string
                  default: "image/jpeg"
                  example: "image/jpeg"
                fileName:
                  type: string
                  default: "capture.jpg"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalysisResult'
              example:
                success: true
                message: "YOLO ë¶„ì„ ì™„ë£Œ"
                data:
                  Ready: 12
                  Not_Ready: 8
                  Disease_Bad: 1
                  Truss: 5
                  ripeness_rate: 60
                  disease_rate: 5

  /disease-diagnosis:
    post:
      tags:
        - AI ë¶„ì„
      summary: ë³‘í•´ì¶© AI ì§„ë‹¨
      description: |
        Gemini AIë¥¼ ì‚¬ìš©í•˜ì—¬ í† ë§ˆí†  ì´ë¯¸ì§€ì˜ ë³‘í•´ì¶©ì„ ì§„ë‹¨í•©ë‹ˆë‹¤.
        
        **ì§„ë‹¨ í•­ëª©:**
        - ê±´ê°• ìƒíƒœ í‰ê°€ (ê±´ê°•/ì£¼ì˜/ìœ„í—˜)
        - ë°œê²¬ëœ ì¦ìƒ
        - ì›ì¸ ë¶„ì„
        - ê¸´ê¸‰ ì¡°ì¹˜ ì‚¬í•­
        - ì¹˜ë£Œ ë°©ë²•
        - ì˜ˆë°© ê´€ë¦¬
      operationId: runDiseaseAnalysis
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  format: byte
                  description: Base64 ì¸ì½”ë”©ëœ ì´ë¯¸ì§€
                mimeType:
                  type: string
                  default: "image/jpeg"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiseaseAnalysis'
              example:
                success: true
                diagnosis: "ğŸ”¬ ì§„ë‹¨ ê²°ê³¼\n\n### 1. ğŸš¦ ê±´ê°• ìƒíƒœ: ì£¼ì˜\nìì— í™©í™” í˜„ìƒì´ ê´€ì°°ë©ë‹ˆë‹¤..."
                healthStatus: "ì£¼ì˜"
                timestamp: "2024-11-21T07:30:00Z"

  # ==================== ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡ ====================
  /predict:
    post:
      tags:
        - ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡
      summary: AI ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡
      description: |
        í™˜ê²½ ì¡°ê±´ì„ ì…ë ¥ë°›ì•„ ML ëª¨ë¸ë¡œ ìˆ˜í™•ëŸ‰ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
        
        **ëª¨ë¸ ì •ë³´:**
        - ì•Œê³ ë¦¬ì¦˜: Random Forest
        - ì •í™•ë„: RÂ² = 0.9084
        - í•™ìŠµ ë°ì´í„°: ë†ì§„ì²­ ìŠ¤ë§ˆíŠ¸íŒœ DB (103,000+ ê±´)
      operationId: predictYield
      servers:
        - url: http://192.168.49.101:8002
          description: ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡ ì„œë²„
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/YieldPredictionRequest'
            example:
              month: 11
              temperature: 25.0
              humidity: 65.0
              co2: 700
              solar_radiation: 1200
              growth_stage: "ìƒìœ¡ì¤‘ê¸°"
              facility_type: "ë¹„ë‹í•˜ìš°ìŠ¤"
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/YieldPredictionResponse'
              example:
                predicted_yield: 18.5
                confidence_interval:
                  lower: 16.2
                  upper: 20.8
                  std_dev: 1.2
                input_summary:
                  month: 11
                  temperature: 25.0
                  humidity: 65.0
                recommendations:
                  - "í˜„ì¬ ì˜¨ë„ê°€ ì ì • ë²”ìœ„ì…ë‹ˆë‹¤."
                  - "ìŠµë„ë¥¼ 70% ìˆ˜ì¤€ìœ¼ë¡œ ë†’ì´ë©´ ìˆ˜í™•ëŸ‰ ì¦ê°€ ê°€ëŠ¥"

  # ==================== ì±—ë´‡ ====================
  /chat-message:
    post:
      tags:
        - ì±—ë´‡
      summary: AI ì±—ë´‡ ë©”ì‹œì§€
      description: |
        Gemini AI ê¸°ë°˜ ë†ì—… ìƒë‹´ ì±—ë´‡ì…ë‹ˆë‹¤.
        í…ìŠ¤íŠ¸ ë˜ëŠ” ì´ë¯¸ì§€ì™€ í•¨ê»˜ ì§ˆë¬¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      operationId: sendChatMessage
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - message
              properties:
                message:
                  type: string
                  description: ì‚¬ìš©ì ë©”ì‹œì§€
                  example: "í† ë§ˆí†  ìì´ ë…¸ë—ê²Œ ë³€í–ˆì–´ìš”. ì›ì¸ì´ ë­˜ê¹Œìš”?"
                image:
                  type: string
                  format: binary
                  description: ì²¨ë¶€ ì´ë¯¸ì§€ (ì„ íƒ)
      responses:
        '200':
          description: ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
              example:
                response: "í† ë§ˆí†  ìì´ ë…¸ë—ê²Œ ë³€í•˜ëŠ” ì›ì¸ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤..."
                timestamp: "2024-11-21T07:30:00Z"
                success: true

  # ==================== ë¼ì¦ˆë² ë¦¬íŒŒì´ ì§ì ‘ API ====================
  /stream:
    get:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° (MJPEG)
      description: |
        ë¼ì¦ˆë² ë¦¬íŒŒì´ ì¹´ë©”ë¼ì˜ ì‹¤ì‹œê°„ MJPEG ìŠ¤íŠ¸ë¦¼ì…ë‹ˆë‹¤.
        
        **ì‚¬ìš©ë²•:** `<Image source={{ uri: 'http://192.168.49.219:8080/stream' }} />`
      operationId: getStream
      servers:
        - url: http://192.168.49.219:8080
      responses:
        '200':
          description: MJPEG ìŠ¤íŠ¸ë¦¼
          content:
            multipart/x-mixed-replace:
              schema:
                type: string
                format: binary

  /snapshot:
    get:
      tags:
        - ì¹´ë©”ë¼ ì œì–´
      summary: ìŠ¤ëƒ…ìƒ· ì´ë¯¸ì§€
      description: í˜„ì¬ í”„ë ˆì„ì˜ JPEG ì´ë¯¸ì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getSnapshot
      servers:
        - url: http://192.168.49.219:8080
      responses:
        '200':
          description: JPEG ì´ë¯¸ì§€
          content:
            image/jpeg:
              schema:
                type: string
                format: binary

components:
  schemas:
    # ===== ê³µí†µ ìŠ¤í‚¤ë§ˆ =====
    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
        code:
          type: string
          example: "INTERNAL_ERROR"

    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤."

    # ===== ì‹¤ì‹œê°„ ë°ì´í„° ìŠ¤í‚¤ë§ˆ =====
    RealtimeData:
      type: object
      properties:
        Ready:
          type: integer
          description: ìˆ˜í™• ê°€ëŠ¥í•œ ì™„ìˆ™ í† ë§ˆí†  ê°œìˆ˜
          example: 45
        Not_Ready:
          type: integer
          description: ë¯¸ì„±ìˆ™ í† ë§ˆí†  ê°œìˆ˜
          example: 23
        Disease_Bad:
          type: integer
          description: ë³‘í•´ í† ë§ˆí†  ê°œìˆ˜
          example: 2
        Truss:
          type: integer
          description: í™”ë°© ê°œìˆ˜
          example: 8

    HistoryData:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              time:
                type: string
                format: date-time
              Ready:
                type: integer
              Not_Ready:
                type: integer
              Disease_Bad:
                type: integer
              Truss:
                type: integer

    DailySummary:
      type: object
      properties:
        total_ready:
          type: integer
          description: ì˜¤ëŠ˜ ì´ ìˆ˜í™• ê°€ëŠ¥ í† ë§ˆí† 
        total_not_ready:
          type: integer
          description: ì˜¤ëŠ˜ ì´ ë¯¸ì„±ìˆ™ í† ë§ˆí† 
        total_disease:
          type: integer
          description: ì˜¤ëŠ˜ ì´ ë³‘í•´ í† ë§ˆí† 
        avg_truss:
          type: integer
          description: í‰ê·  í™”ë°© ìˆ˜

    # ===== ì‹œì¥ ê°€ê²© ìŠ¤í‚¤ë§ˆ =====
    PriceCompare:
      type: object
      properties:
        success:
          type: boolean
        date:
          type: string
          format: date
        wholesale_summary:
          type: object
          properties:
            high:
              type: integer
              description: ìƒí’ˆ ë„ë§¤ê°€ (ì›/kg)
            mid:
              type: integer
              description: ì¤‘í’ˆ ë„ë§¤ê°€ (ì›/kg)
            cherry:
              type: integer
              description: ë°©ìš¸í† ë§ˆí†  ë„ë§¤ê°€ (ì›/kg)
        online_summary:
          type: object
          properties:
            lowest_price:
              type: integer
              description: ìµœì € ì†Œë§¤ê°€
            lowest_mall:
              type: string
              description: ìµœì €ê°€ íŒë§¤ì²˜
            lowest_title:
              type: string
              description: ìµœì €ê°€ ìƒí’ˆëª…
            lowest_link:
              type: string
              description: ìµœì €ê°€ ìƒí’ˆ ë§í¬
            median_price:
              type: integer
            average_price:
              type: integer
        comparison:
          type: array
          items:
            type: object
            properties:
              grade:
                type: string
              wholesale_price:
                type: integer
              online_lowest:
                type: integer
              margin_rate:
                type: integer
                description: ë§ˆì§„ìœ¨ (%)

    PriceHistory:
      type: object
      properties:
        success:
          type: boolean
        period:
          type: object
          properties:
            start:
              type: string
              format: date
            end:
              type: string
              format: date
        count:
          type: integer
        stats:
          type: object
          properties:
            high:
              $ref: '#/components/schemas/PriceStats'
            mid:
              $ref: '#/components/schemas/PriceStats'
        data:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              high:
                type: integer
              mid:
                type: integer
              cherry:
                type: integer

    PriceStats:
      type: object
      properties:
        min:
          type: integer
        max:
          type: integer
        avg:
          type: integer
        change:
          type: integer

    MarketPrice:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            item_name:
              type: string
            price:
              type: integer
            yesterday_price:
              type: integer
            change:
              type: integer
            change_rate:
              type: number
            direction:
              type: string
              enum: [up, down, same]
            date:
              type: string
              format: date

    # ===== ì¹´ë©”ë¼ ìŠ¤í‚¤ë§ˆ =====
    CameraStatus:
      type: object
      properties:
        monitoring:
          type: boolean
          description: ëª¨ë‹ˆí„°ë§ í™œì„±í™” ì—¬ë¶€
        interval:
          type: integer
          description: ì´¬ì˜ ê°„ê²© (ì´ˆ)
        last_capture:
          type: string
          format: date-time
          description: ë§ˆì§€ë§‰ ì´¬ì˜ ì‹œê°„
        white_balance:
          type: string
          description: í™”ì´íŠ¸ ë°¸ëŸ°ìŠ¤ ëª¨ë“œ

    CaptureResult:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          type: object
          properties:
            Ready:
              type: integer
            Not_Ready:
              type: integer
            Disease_Bad:
              type: integer
            Truss:
              type: integer
            ripeness_rate:
              type: integer
              description: ì„±ìˆ™ë„ (%)
            disease_rate:
              type: integer
              description: ë³‘í•´ìœ¨ (%)
        timestamp:
          type: string
          format: date-time

    # ===== AI ë¶„ì„ ìŠ¤í‚¤ë§ˆ =====
    AnalysisResult:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          type: object
          properties:
            Ready:
              type: integer
            Not_Ready:
              type: integer
            Disease_Bad:
              type: integer
            Truss:
              type: integer
            ripeness_rate:
              type: integer
            disease_rate:
              type: integer

    DiseaseAnalysis:
      type: object
      properties:
        success:
          type: boolean
        diagnosis:
          type: string
          description: AI ì§„ë‹¨ ê²°ê³¼ (ë§ˆí¬ë‹¤ìš´ í˜•ì‹)
        healthStatus:
          type: string
          enum: [ê±´ê°•, ì£¼ì˜, ìœ„í—˜, ì˜¤ë¥˜]
          description: ê±´ê°• ìƒíƒœ ìš”ì•½
        timestamp:
          type: string
          format: date-time

    # ===== ìˆ˜í™•ëŸ‰ ì˜ˆì¸¡ ìŠ¤í‚¤ë§ˆ =====
    YieldPredictionRequest:
      type: object
      required:
        - month
        - temperature
        - humidity
      properties:
        month:
          type: integer
          minimum: 1
          maximum: 12
          description: ì˜ˆì¸¡ ì›”
        temperature:
          type: number
          description: í‰ê·  ì˜¨ë„ (Â°C)
        humidity:
          type: number
          description: í‰ê·  ìŠµë„ (%)
        co2:
          type: number
          description: COâ‚‚ ë†ë„ (ppm)
          default: 700
        solar_radiation:
          type: number
          description: ì¼ì‚¬ëŸ‰ (J/ã )
          default: 1200
        growth_stage:
          type: string
          enum: [ìƒìœ¡ì´ˆê¸°, ìƒìœ¡ì¤‘ê¸°, ìƒìœ¡í›„ê¸°, ìˆ˜í™•ê¸°]
          default: "ìƒìœ¡ì¤‘ê¸°"
        facility_type:
          type: string
          enum: [ë¹„ë‹í•˜ìš°ìŠ¤, ìœ ë¦¬ì˜¨ì‹¤]
          default: "ë¹„ë‹í•˜ìš°ìŠ¤"

    YieldPredictionResponse:
      type: object
      properties:
        predicted_yield:
          type: number
          description: ì˜ˆì¸¡ ìˆ˜í™•ëŸ‰ (kg/3.3ã¡)
        confidence_interval:
          type: object
          properties:
            lower:
              type: number
              description: í•˜í•œê°’
            upper:
              type: number
              description: ìƒí•œê°’
            std_dev:
              type: number
              description: í‘œì¤€í¸ì°¨
        input_summary:
          type: object
          description: ì…ë ¥ê°’ ìš”ì•½
        recommendations:
          type: array
          items:
            type: string
          description: AI ì¶”ì²œì‚¬í•­

    # ===== ì±—ë´‡ ìŠ¤í‚¤ë§ˆ =====
    ChatResponse:
      type: object
      properties:
        response:
          type: string
          description: AI ì‘ë‹µ ë©”ì‹œì§€
        timestamp:
          type: string
          format: date-time
        success:
          type: boolean
